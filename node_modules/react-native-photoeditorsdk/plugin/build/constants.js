"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.imgly_config_regex = exports.multidex = exports.replacementForTag = exports.ConfigurationTag = void 0;
/** Tags for the config plugin. */
var ConfigurationTag;
(function (ConfigurationTag) {
    ConfigurationTag["Multidex"] = "MULTIDEX";
    ConfigurationTag["MultidexConfig"] = "MULTIDEX_CONFIG";
    ConfigurationTag["Modules"] = "MODULES";
    ConfigurationTag["Repos"] = "REPOS";
    ConfigurationTag["Maven"] = "MAVEN";
})(ConfigurationTag = exports.ConfigurationTag || (exports.ConfigurationTag = {}));
function replacementForTag(tag, userInfo) {
    switch (tag) {
        case ConfigurationTag.Maven:
            return imgly_allprojects_block;
        case ConfigurationTag.Modules:
            return customizedModules(userInfo);
        case ConfigurationTag.Multidex:
            return multidex_replacement_block;
        case ConfigurationTag.MultidexConfig:
            return multidex_config_block;
        case ConfigurationTag.Repos:
            if (typeof userInfo === 'string') {
                sdk_version = userInfo;
                return imgly_repos_block(userInfo);
            }
            return imgly_repos_block();
    }
}
exports.replacementForTag = replacementForTag;
function customizedModules(userInfo) {
    var config = imgly_config_block;
    if (Array.isArray(userInfo)) {
        userInfo.forEach((value) => {
            const match = `        include '${value}'\n`;
            if (config.match(match)) {
                config = config.replace(match, '');
            }
        });
    }
    return config;
}
/** The multidex declaration for the `MainApplication.java`. */
exports.multidex = 'class MainApplication extends Application';
/** The modules for the android/app/build.gradle. */
exports.imgly_config_regex = 'apply plugin: "com.android.application"';
/** The multidex declaration for the build.gradle. */
const multidex_config_block = `
android {
    defaultConfig {
        multiDexEnabled true
    }
}
dependencies {
    implementation 'androidx.multidex:multidex:2.0.1'
}
`;
/** The version of the native Android SDK that is needed for the plugins. */
var sdk_version = '9.1.0';
/** The multidex declaration for the `MainApplication.java`. */
const multidex_replacement_block = 'class MainApplication extends androidx.multidex.MultiDexApplication';
/** The modules for the android/app/build.gradle. */
const imgly_config_block = `
apply plugin: 'ly.img.android.sdk'
apply plugin: 'kotlin-android'

// Comment out the modules you don't need, to save size.
imglyConfig {
    modules {
        include 'ui:text'
        include 'ui:focus'
        include 'ui:frame'
        include 'ui:brush'
        include 'ui:filter'
        include 'ui:sticker'
        include 'ui:overlay'
        include 'ui:transform'
        include 'ui:adjustment'
        include 'ui:text-design'
        include 'ui:video-trim'
        include 'ui:video-library'
        include 'ui:video-composition'
        include 'ui:audio-composition'

        // This module is big, remove the serializer if you don't need that feature.
        include 'backend:serializer'

        // Remove the asset packs you don't need, these are also big in size.
        include 'assets:font-basic'
        include 'assets:frame-basic'
        include 'assets:filter-basic'
        include 'assets:overlay-basic'
        include 'assets:sticker-shapes'
        include 'assets:sticker-emoticons'
        include 'assets:sticker-animated'

        include 'backend:sticker-animated'
        include 'backend:sticker-smart'
    }
}
`;
/** The repositories for all projects. */
const imgly_allprojects_block = `
allprojects {
    repositories {
        maven { url "https://artifactory.img.ly/artifactory/imgly" }
    }
}
`;
/** The repositories for the android/build.gradle. */
function imgly_repos_block(version) {
    return `buildscript {
    repositories {
        maven { url "https://artifactory.img.ly/artifactory/imgly" }
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:1.4.10"
        classpath 'ly.img.android.sdk:plugin:${version !== null && version !== void 0 ? version : sdk_version}'
    }
}
`;
}
